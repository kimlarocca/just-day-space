import{H as Z,T as ee,a as se}from"./xoGKI7zM.js";import{_ as ae}from"./3NSENS5s.js";import{_ as le,v as z,h as r,r as h,o,c as x,f as s,k as I,g as v,a as e,d as c,t as C,F as J,b as n,w as k,p as oe,e as te,j as W,i as T,l as ne,x as re,s as ue,y as ie,z as q}from"./BgijtkFZ.js";import{u as K}from"./BtaJPrrX.js";import{u as A}from"./CpgKnvAJ.js";const ce=S=>(oe("data-v-1c789c2b"),S=S(),te(),S),de={class:"upload-image"},_e={key:2},me={key:0,class:"mb-3"},pe={class:"flex flex-column lg:flex-row"},fe={key:1,class:"small mt-3"},ve=ce(()=>e("em",null,[c(" Image files must be less than 1MB in size, and should ideally be a square."),e("br"),c("jpg, png, webp, and gif files are accepted. ")],-1)),he=[ve],ge={__name:"UploadImage",props:{image:{type:String,default:"",required:!0}},setup(S){const u=z(),M=K(),p=A(),f=S,$=r(!1),l=r(),t=r(),a=r(f.image),d=async i=>{try{$.value=!0;const g=i.files[0],w=g.name.split(".").pop(),_=`${f.userId}-${Math.random()}.${w}`,{error:V}=await p.storage.from("avatars").upload(_,g);if(V)throw V;const{data:b}=await p.storage.from("avatars").getPublicUrl(_);a.value=b.publicUrl;const{error:m}=await p.from("profiles").upsert({id:u.value.id,updated_at:new Date().toISOString(),avatar_url:a.value}).match({id:u.value.id});m?(console.log(m),l.value=`Error: ${m}`):(t.value="Success! Your image has been saved.",M.value.avatar_url=a.value)}catch(g){l.value=`Error: ${g}`}finally{$.value=!1}},P=async()=>{const{error:i}=await p.from("profiles").upsert({id:u.value.id,updated_at:new Date().toISOString(),avatar_url:null}).match({id:u.value.id});i?(console.log(i),l.value=`Error: ${i}`):(t.value="Success! Your photo has been deleted.",a.value=null,M.value.avatar_url=null)};return(i,g)=>{const w=h("ProgressSpinner"),_=h("Avatar"),V=h("FileUpload"),b=h("Button"),m=h("Message");return o(),x("div",de,[s($)?(o(),I(w,{key:0,class:"inline-block mb-4"})):v("",!0),s(a)?(o(),I(_,{key:1,image:s(a),size:"xlarge",shape:"circle",alt:"profile photo",class:"mb-4"},null,8,["image"])):v("",!0),s(u).app_metadata.provider==="google"?(o(),x("p",_e,[e("em",null,[c(" You are using your "),e("strong",null,C(s(u).email),1),c(" Google account to login. To change your profile picture, you must do so through your Google account. ")])])):(o(),x(J,{key:3},[s(a)?v("",!0):(o(),x("p",me," You have not added a profile photo yet. ")),e("div",pe,[n(V,{mode:"basic",customUpload:!0,onUploader:d,accept:"image/*",maxFileSize:1e6,fileLimit:1,"choose-label":"Update Photo",auto:!0,"upload-icon":"pi pi-image"}),s(a)?(o(),I(b,{key:0,onClick:P,class:"mt-3 lg:mt-0 lg:ml-3 p-button-outlined fit-width",label:"Delete",icon:"pi pi-trash"})):v("",!0)]),s(a)?v("",!0):(o(),x("p",fe,he))],64)),s(l)?(o(),I(m,{key:4,class:"mt-4",severity:"error"},{default:k(()=>[c(C(s(l)),1)]),_:1})):v("",!0),s(t)?(o(),I(m,{key:5,sticky:!1,life:5e3,class:"mt-4",severity:"success"},{default:k(()=>[c(C(s(t)),1)]),_:1})):v("",!0)])}}},be=le(ge,[["__scopeId","data-v-1c789c2b"]]),we={key:0},ye={class:"text-sm mb-4"},ke={key:1,class:"flex flex-column lg:flex-row lg:align-items-center mb-5"},$e=e("p",{class:"mb-3 lg:mb-0 lg:mr-3 block md:inline text-sm"},"User Type:",-1),Ue={class:"mb-3 lg:mb-0 lg:mr-3 block lg:inline"},xe=e("label",{for:"farm_owner"},"Cannabis Farm Owner",-1),Pe={class:"mb-3 lg:mb-0 lg:mr-3 block lg:inline"},Ve=e("label",{for:"hemp_farm_owner"},"Hemp Farm Owner",-1),Ie={class:"mb-3 lg:mb-0 lg:mr-3 block lg:inline"},Se=e("label",{for:"lab_owner"},"Extraction Lab Owner",-1),Me={class:"mb-4"},Ce={class:"p-float-label inline"},Te=e("label",{for:"full_name"},"Full Name",-1),Ne={class:"mb-4"},Be={class:"p-float-label inline"},Oe=e("label",{for:"phone"},"Phone Number",-1),Fe={class:"mb-4"},De={class:"p-float-label inline"},Ee=e("label",{for:"workers"},"Total Number Of Workers",-1),Ye={class:"mb-4"},He={class:"p-float-label inline"},qe=e("label",{for:"lights"},"Total Number Of Lights",-1),ze={class:"changes-saved-toast"},Ae={__name:"ManageUserProfile",props:{hideUserType:{type:Boolean,default:!1}},async setup(S){var F,N,B,D,E,Y,H;let u,M;const p=z(),f=K(),$=A(),l=r(null),t=r(null),a=r(null),d=r(null),P=r(null),i=r(null),g=r([]),w=r(!1),_=r(!1),V=r(null);let{data:b}=([u,M]=W(()=>$.from("profiles").select("*").eq("id",p.value.id).limit(1)),u=await u,M(),u);b&&(g.value=b,l.value=(F=b[0])==null?void 0:F.farm_owner,t.value=(N=b[0])==null?void 0:N.hemp_farm_owner,a.value=(B=b[0])==null?void 0:B.full_name,d.value=(D=b[0])==null?void 0:D.lab_owner,P.value=(E=b[0])==null?void 0:E.number_of_lights,i.value=(Y=b[0])==null?void 0:Y.phone,V.value=(H=b[0])==null?void 0:H.number_of_workers,!l.value&&!d.value&&!t.value&&(_.value=!0));const m=async()=>{if(!l.value&&!d.value&&!t.value){_.value=!0;return}_.value=!1,w.value=!1;const{error:O}=await $.from("profiles").upsert({id:p.value.id,updated_at:new Date().toISOString(),farm_owner:l.value,hemp_farm_owner:t.value,full_name:a.value,lab_owner:d.value,number_of_lights:P.value,number_of_workers:V.value,phone:i.value}).match({id:p.value.id});O?console.log("updateProfile error",O):(w.value=!0,f.value.farm_owner=l.value,f.value.hemp_farm_owner=t.value,f.value.full_name=a.value,f.value.lab_owner=d.value,f.value.number_of_lights=P.value,f.value.number_of_workers=V.value,f.value.phone=i.value)};return(O,y)=>{var G;const j=h("Message"),L=h("Checkbox"),Q=h("InputText"),X=h("InputMask"),R=h("InputNumber");return o(),x(J,null,[s(g)&&s(g).length>0?(o(),x("div",we,[e("p",ye,"Username: "+C((G=s(p))==null?void 0:G.email),1),s(_)&&!S.hideUserType?(o(),I(j,{key:0,severity:"error",closable:!1,class:"mb-4"},{default:k(()=>[c(" Please select at least one user type! ")]),_:1})):v("",!0),S.hideUserType?v("",!0):(o(),x("div",ke,[$e,e("div",Ue,[n(L,{id:"farm_owner",modelValue:s(l),"onUpdate:modelValue":y[0]||(y[0]=U=>T(l)?l.value=U:null),binary:!0,class:"mr-2",onChange:m},null,8,["modelValue"]),xe]),e("div",Pe,[n(L,{id:"hemp_farm_owner",modelValue:s(t),"onUpdate:modelValue":y[1]||(y[1]=U=>T(t)?t.value=U:null),binary:!0,class:"mr-2",onChange:m},null,8,["modelValue"]),Ve]),e("div",Ie,[n(L,{id:"lab_owner",modelValue:s(d),"onUpdate:modelValue":y[2]||(y[2]=U=>T(d)?d.value=U:null),binary:!0,class:"mr-2",onChange:m},null,8,["modelValue"]),Se])])),e("div",Me,[e("span",Ce,[n(Q,{id:"full_name",modelValue:s(a),"onUpdate:modelValue":y[3]||(y[3]=U=>T(a)?a.value=U:null),onChange:m},null,8,["modelValue"]),Te])]),e("div",Ne,[e("span",Be,[n(X,{modelValue:s(i),"onUpdate:modelValue":y[4]||(y[4]=U=>T(i)?i.value=U:null),date:"phone",mask:"(999) 999-9999",placeholder:"(999) 999-9999",onChange:m},null,8,["modelValue"]),Oe])]),e("div",Fe,[e("span",De,[n(R,{id:"workers",modelValue:s(V),"onUpdate:modelValue":[y[5]||(y[5]=U=>T(V)?V.value=U:null),m],onInput:m},null,8,["modelValue"]),Ee])]),e("div",Ye,[e("span",He,[n(R,{id:"lights",modelValue:s(P),"onUpdate:modelValue":[y[6]||(y[6]=U=>T(P)?P.value=U:null),m],onInput:m},null,8,["modelValue"]),qe])])])):v("",!0),e("div",ze,[s(w)?(o(),I(j,{key:0,class:"mb-4",severity:"success",closable:!1,sticky:!1},{default:k(()=>[c(" Your changes have been saved. ")]),_:1})):v("",!0)])],64)}}},Le=e("h4",{class:"mb-4"},"Change Password",-1),je={key:0},Re={key:1,class:"width400"},Ge={class:"mb-4"},Je={key:0,class:"p-float-label inline"},We=e("label",{for:"password"},"New Password",-1),Ke={__name:"ResetPassword",setup(S){const u=z(),M=A(),p=r(""),f=r(""),$=r(!1),l=r(null),t=async()=>{$.value=!0;const{error:a}=await M.auth.updateUser({email:u.value.email,password:f.value});$.value=!1,a?(console.log(a),a.toString().includes("8 characters")?p.value="Password should be at least 8 characters.":p.value=a):l.value="Success! Your password has been updated."};return(a,d)=>{const P=h("Password"),i=h("Button"),g=h("Message");return o(),x("div",null,[e("form",{class:"password-reset",onSubmit:ne(t,["prevent"])},[Le,s(u).app_metadata.provider!=="email"?(o(),x("p",je,[e("em",null,[c(" You are using your "),e("strong",null,C(s(u).email),1),c(" "+C(s(u).app_metadata.provider)+" account to login. To change your password, you must do so through your "+C(s(u).app_metadata.provider)+" account. ",1)])])):(o(),x("div",Re,[e("div",Ge,[s(l)?v("",!0):(o(),x("span",Je,[n(P,{id:"password",toggleMask:"",modelValue:s(f),"onUpdate:modelValue":d[0]||(d[0]=w=>T(f)?f.value=w:null),type:"password",placeholder:"New Password",required:""},null,8,["modelValue"]),We]))]),s(l)?v("",!0):(o(),I(i,{key:0,loading:s($),type:"submit",class:"full-width",label:"Update Password"},null,8,["loading"]))])),s(p)?(o(),I(g,{key:2,sticky:!1,life:5e3,class:"mt-4",severity:"error",onClose:d[1]||(d[1]=w=>p.value="")},{default:k(()=>[c(" Sorry, there was an error updating your password: "+C(s(p)),1)]),_:1})):v("",!0),s(l)?(o(),I(g,{key:3,sticky:!0,life:5e3,class:"mt-4",severity:"success",onClose:d[2]||(d[2]=w=>l.value="")},{default:k(()=>[c(C(s(l)),1)]),_:1})):v("",!0)],32)])}}},Qe={key:0,class:"settings"},Xe={class:"grid"},Ze={class:"col hidden col-12 lg:col-3 lg:flex mb-4"},es={class:"container-white w-full h-fit p-4"},ss=e("i",{class:"pi pi-cog mr-2"},null,-1),as=e("i",{class:"pi pi-map-marker mr-2"},null,-1),ls=e("i",{class:"pi pi-lock mr-2"},null,-1),os=e("i",{class:"pi pi-trash mr-2"},null,-1),ts={class:"col col-12 lg:col-9"},ns={id:"profile",class:"container-white p-4 mb-4"},rs=e("h4",{class:"mb-4"},"Profile",-1),us={id:"locations",class:"container-white p-4 mb-4"},is=e("h4",{class:"mb-4"},"Projects",-1),cs={id:"password",class:"container-white p-4 mb-4"},ds=e("div",{id:"delete",class:"container-white p-4 mb-4"},[e("h4",{class:"mb-4"},"Delete Account"),e("p",null,[c(" Please "),e("a",{href:"mailto:help@cuetip.com"},"contact us"),c(" if you wish to delete your account. ")])],-1),_s={class:"changes-saved-toast"},gs={__name:"settings",async setup(S){var g,w;let u,M;const p=z(),f=A(),$=re(),l=r(null),t=r(null),a=r([]),d=r(!1),P=r(null);ue(()=>{if(t.value=$.hash,window.location.hash){const _=document.getElementById(window.location.hash.slice(1));_&&(_.scrollIntoView(),t.value=window.location.hash)}}),ie(()=>$.hash,_=>{t.value=_});let{data:i}=([u,M]=W(()=>{var _;return f.from("profiles").select("*").eq("id",(_=p.value)==null?void 0:_.id).limit(1)}),u=await u,M(),u);return i&&(a.value=i,l.value=(g=i[0])==null?void 0:g.avatar_url,P.value=(w=i[0])==null?void 0:w.user_type),(_,V)=>{const b=ee,m=se,F=Z,N=ae,B=h("divider"),D=be,E=Ae,Y=h("manage-user-locations"),H=Ke,O=h("Message");return s(a)&&s(a).length>0?(o(),x("div",Qe,[n(F,{lang:"en"},{default:k(()=>[n(m,null,{default:k(()=>[n(b,null,{default:k(()=>[c("Just Day Space | Profile Settings")]),_:1})]),_:1})]),_:1}),e("div",Xe,[e("div",Ze,[e("nav",es,[e("p",null,[n(N,{to:"#profile",class:q(["plain",s(t)==="#profile"?"active":""])},{default:k(()=>[ss,c(" Profile ")]),_:1},8,["class"])]),n(B,{class:"my-3"}),e("p",null,[n(N,{to:"#locations",class:q(["plain",s(t)==="#profile"?"active":""])},{default:k(()=>[as,c(" Locations ")]),_:1},8,["class"])]),n(B,{class:"my-3"}),e("p",null,[n(N,{to:"#password",class:q(["plain",s(t)==="#password"?"active":""])},{default:k(()=>[ls,c(" Change Password ")]),_:1},8,["class"])]),n(B,{class:"my-3"}),e("p",null,[n(N,{to:"#delete",class:q(["plain",s(t)==="#delete"?"active":""])},{default:k(()=>[os,c(" Delete Account ")]),_:1},8,["class"])])])]),e("div",ts,[e("div",ns,[rs,n(D,{image:s(l)||"",class:"mb-5"},null,8,["image"]),n(E)]),e("div",us,[is,n(Y)]),e("div",cs,[n(H)]),ds,e("div",_s,[s(d)?(o(),I(O,{key:0,class:"mb-4",severity:"success",closable:!1,sticky:!1},{default:k(()=>[c(" Your changes have been saved. ")]),_:1})):v("",!0)])])])])):v("",!0)}}};export{gs as default};
